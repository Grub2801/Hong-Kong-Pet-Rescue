app.controller('AdminShelterCtrl', ['$scope', '$auth', '$http', 'ShelterAnimalFactory', '$stateParams', function ($scope, $auth, $http, ShelterAnimalFactory, $stateParams){

  $scope.shelterAnimal = {};
  var ShelterAnimals = ShelterAnimalFactory;

  //show animals that belong to one shelter
  $scope.shelterAnimals = ShelterAnimals.query({shelterId:$stateParams.shelterId})

  $scope.displayEditButtons = function () {
    $scope.editing = true;
  }
  $scope.displayAddButton = function () {
    $scope.editing = false;
  }

  //delete an animal from a shelter
  $scope.deleteAnimal = function (id){
    ShelterAnimals.delete({shelterId: $stateParams.shelterId, id: id }, function (resp) {
      console.log(resp);
      var index = $scope.shelterAnimals.indexOf(id);
      $scope.shelterAnimals.splice(index, 1);
    }, function (resp) {
      console.log(resp);
    });
  }

  // fill the form to edit an animal
  $scope.editAnimal = function(animal){
    $scope.shelterAnimal = animal;
  }

  // post a new animal
  $scope.addAnimal = function (id) {
    if ($scope.shelterAnimal.id) {
      var id = $scope.shelterAnimal.id;
      ShelterAnimals.update({shelterId: $stateParams.shelterId, id: id}, $scope.shelterAnimal, function (resp) {
        console.log(resp);
        $scope.shelterAnimal = {};
      }, function (resp) {
        console.log(resp);
      });
    } else {
      ShelterAnimals.save({shelterId: $stateParams.shelterId}, $scope.shelterAnimal, function (shelterAnimal) {
        console.log(shelterAnimal);
        $scope.shelterAnimals.push(shelterAnimal);
        $scope.shelterAnimal = {};
      }, function (resp) {
        console.log(resp);
      });
    }
  }
}])